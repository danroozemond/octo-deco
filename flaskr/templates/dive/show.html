{% extends 'base.html' %}

{% block extrascripts %}
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>
{% endblock %}

{% block header %}
  {% block title %}Dive{% endblock %}
{% endblock %}

{# block sidebarheader %} Hello for the {{ session['count'] }}th time {% endblock #}


{% block sidebaritems %}
    <li class="first"><span class="fa fa-check"></span><a href="#diveprofile">Dive profile</a></li>
    <li><span class="fa fa-check"></span><a href="#divesummary">Dive summary</a></li>
    <li><span class="fa fa-check"></span><a href="#heatmap">Heatmap</a></li>
    <li><span class="fa fa-check"></span><a href="#fulldata">Full dive data</a></li>
{% endblock %}

{% block content %}
    <a name="diveprofile"></a>
    <div class="chart" id="chart_diveprofile">
        <script>
            var graphs = {{dive_profile_plot_json | safe}};
            Plotly.plot('chart_diveprofile',graphs,{});
        </script>
    </div>

    <a name="divesummary"></a>
    <h2>Dive summary</h2>
    {{ summary_table|safe }}

    <a name="heatmap"></a>
    <script>
        function toggleHeatmap(toggle_elt)
        {
            elt = document.getElementById("heatmap");
            if ( elt.style.display == "block" )
            {
                elt.style.display="none";
                toggle_elt.innerHTML = "[show]";
            }
            else
            {
                elt.style.display="block";
                toggle_elt.innerHTML = "[hide]";
                var graphs = {{heatmap_plot_json | safe}};
                Plotly.plot('chart_heatmap',graphs,{});
            }
        }
    </script>
    <h2>Tissue heatmap<div class="viztoggle" onclick="toggleHeatmap(this)">[show]</div></h2>
    <div id="heatmap" style="display: none">
        <p>Displays (scaled) compartment pressure (actually: GF99)</p>
        <div class="chart" id="chart_heatmap">
        </div>
    </div>

    <a name="fulldata"></a>
    <script>
        function toggleFulldata(toggle_elt)
        {
            elt = document.getElementById("fulldata");
            if ( elt.style.display == "block" )
            {
                elt.style.display="none";
                toggle_elt.innerHTML = "[show]";
            }
            else
            {
                elt.style.display="block";
                toggle_elt.innerHTML = "[hide]";
            }
        }
    </script>
    <h2>Full dive data
        <div class="viztoggle" onclick="toggleFulldata(this)">[show]</div>
        <div class="viztoggle"><a href="{{url_for('dive.csv',id=1)}}">[csv]</a></div>
    </h2>
    <div id="fulldata" class="bigtable" style="display: none">
        {{ fulldata_table|safe }}
    </div>

{% endblock %}

